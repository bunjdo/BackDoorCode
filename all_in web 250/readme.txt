all_in
Web за 200-300 очей

Задание содержит в себе сразу несколько разных web-уязвимостей. Главная задача - залогиниться под админом.

Решальщику дан адрес страницы, переходя которой он попадает на страницу регистрации.
1.
Логин, пароль, пол - всё введено, решальщик переходит на второй этап регистрации.
2.
Решальщик видит халтурное лицензионное соглашение. После тщетных попыток согласиться, 
догадывается что кнопочка сама по себе не работает. Обращает свой взор в URL-адрес, 
где видит GET-параметр, который содержит в себе строку, закодированную в base64 (достаточно очевидно).
Декодируя строку, видит что в строке есть место, куда он должен вставить свой логин.
Вставив, закодировав обратно, подменив GET-параметр на новый, получив страницу заново, решальщик 
переходит на 3 страницу регистрации.
3.
Решальщику сообщают о том, что его логин зарегистрирован и теперь он может войти в систему, но ссылки 
на форму входа нигде нет. Посмотрев внимательнее на URL-адрес необходимо заметить, что полученные ранее страницы 
имели номера 1, 2 и 3. Попробовав перейти на страницу 4, решальщик попадает на страницу sign-in с формой входа.
4.
Введя ранее зарегистрированные данные, решальщик попадает в подобие личного кабинета. В ЛК есть кнопка для получения 
флага, но при нажатии нам сообщают, что этот сервис доступен только для суперюзера, а, точнее, для админа. 
Здесь, решальщик может сразу попробовать залогиниться под админом, а может сначала подумать, 
где обычно хранятся данные об авторизированном пользователе. Обычно для этого используют сессии, но тогда наша система 
была бы слишкой сложной для взлома, поэтому у нас эти данные хранятся в куки-файлах, которые можно прочесть используя 
любой браузер. В куках хранятся такие данные из БД как ID, login, pass, sex. Нужны только логин и пасс. 
Пароль хранится не в чистом виде, а в md5 хэше, да не просто в хэше, а в его перевернутой форме (реверс строки). 
Узнать это можно только обернув в md5 уже известный пароль и посмотрев на получившееся в куках. Зная всё это, можно 
перейти к последнему шагу - к авторизации под админом.
5.
Манипуляции с логином и хэшем пароля в куках не приводят к разблокированию сервиса получения флага, а значит выход 
только один - залогиниться под админом. Вернувшись на страницу входа, решальщик пробует применить SQL-injection, но 
форма входа сообщает ему, что никакие другие символы, кроме латинских букв и цифр, вводить нельзя. Решальщика это 
не должно останавливать, ибо это лишь элемент html-страницы, доступ к которой у него есть. Удалив свойство pattern в 
полях формы, решальщик сможет применить инъекцию "' or 1=1 #" к полю с логином и успешно залогиниться под админом. 
Далее он должен достать из куков хэш пароля, реверснуть строку и декодировать md5 хэш (см. п.4). Т.к. пароль от админа 
простой, то этот хэш сможет декодировать любой онлайн-md5-хэш-декодер. Узнав пароль, получает флаг.

Несмотря на то что тут так много написано, таск простой и усложнен только некоторой волокитой с хэшем и 
SQL-injection, из-за чего считаю нормальным присвоить таску ценность в 250 или 300 очей.